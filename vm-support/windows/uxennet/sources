TARGETNAME = uxennet
TARGETTYPE = DRIVER

!include ../common/sources.inc

!if defined(UXEN_BUILD_INFO)
RCOPTIONS=$(RCOPTIONS) /DBUILD_INFO=$(UXEN_BUILD_INFO)
USER_C_FLAGS=$(USER_C_FLAGS) /DBUILD_INFO=$(UXEN_BUILD_INFO)
!endif

INF_NAME = uxennet

NTTARGETFILE0 = $(OBJ_PATH)\$(O)\$(INF_NAME).inf
PASS0_BINPLACE = $(NTTARGETFILE0)

NTTARGETFILE1 = COPY
NTTARGETFILE2 = POST

INCLUDES=..\..\..\common\include\xen-public;..\common;$(UXENV4VLIB_INC);..\uxenplatform

TARGETLIBS=$(DDK_LIB_PATH)\ndis.lib $(UXENV4VLIB_LIB)

LINKER_FLAGS = $(LINKER_FLAGS) /LTCG:NOSTATUS /SECTION:.rsrc,!d

C_DEFINES=$(C_DEFINES) -DNDIS_MINIPORT_DRIVER=1
C_DEFINES=$(C_DEFINES) -DNDIS_WDM=1 -DIOCTL_INTERFACE
C_DEFINES= $(C_DEFINES) -D_WIN32 -DUNICODE -D_UNICODE -DPC_IMPLEMENTATION
C_DEFINES=$(C_DEFINES) -DNDIS51_MINIPORT=1

C_DEFINES= $(C_DEFINES) -DDEBUG_LEVEL=DEBUGLVL_ERROR
#C_DEFINES= $(C_DEFINES) -DDEBUG_LEVEL=DEBUGLVL_TERSE
#C_DEFINES= $(C_DEFINES) -DDEBUG_LEVEL=DEBUGLVL_VERBOSE
#C_DEFINES= $(C_DEFINES) -DDEBUG_LEVEL=DEBUGLVL_BLAB

SOURCES = \
	miniport.c \
	init.c \
	request.c \
	send.c \
	recv.c \
        ioctl.c \
	uxen_net.c \
	platform.c \
	netvmini.rc


